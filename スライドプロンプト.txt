添付のコードは、小説の「場面」を執筆支援するアプリである。
以下の機能を変更、追加してください。
その他の機能、配置、表現、デザイン等は、省略などもせず、絶対に変更しないでください。
ーーーーーー
１．タブ２（最適化）において、現状、ブラックボックス最適化を行っているが、これを廃止する。
そのため、評価1から５のラジオチェックボタンは無くす。代わりにユーザーが「採用」するかどうかのボタンを設定する。
２．タブ２におけるアルゴリズムは、「多目的最適化」を以下の手順で行う。①「パラメータのみで最適化」は現状のままとする。
最適化された結果は、該当する文章の部品がハイライトされる。このとき、その結果は、「採用」ボタンには影響しない。
②「採用」のボタンはユーザのみが指定できるものとする。③ユーザが「採用」ボタンで文章の部品を選択したのち、
「ユーザの指示を反映して最適化」をクリックすると、以下の「多目的最適化」が行われる。
④「多目的最適化」は、まず、文字数の制約条件のみで最適化を行う。
このとき、目的関数である、シーンとの関連度、パラメータ（シーン描写とキャラクタ造成）との関連度の概算値を得る。
次に、目的関数である、シーンとの関連度と、パラメータとの関連度を先に求めた概算値で割って正規化する。
最後に、最終的な目的関数として、正規化したシーンとの関連度に重み係数：10、正規化されたパラメータとの関連度に重み係数：５、
文字数制約に重み係数：１、ユーザの「採用」条件に重み係数：100を与えるた線形和にする。
この線形和を最適化ソルバーに与えて最適化を計算する。
最適化された文章の部品は、ハイライトされる。このとき、その結果は、「採用」ボタンには影響しない。
３．タブ５（挿絵挿入）を追加する。
４．挿絵の画像は、gemini-2.5-flash-imageを使って生成する。
５．タブ５では、①「挿絵設定候補の生成」ボタンをクリックすると、「場面の候補」が5つ、と「スタイルの候補」が５つ表示される。
「場面の候補」は、タブ４（仕上げ）の最終出力文章を考慮して作成される。
例えば、最終文章が店舗での買い物であれば、
「お店のカウンター」、「店員との対話」、「主人公の笑顔」など５つ表示される。
「スタイルの候補」は、最終出力に似合う、小説の書籍でよく使われている挿絵のペーストが５つ表示される。
これらの候補は、ユーザーがラジオチェックボタンで選択できる。
加えて、ユーザーが好みを指定できるテキストボックスも用意する。
６．タブ５では、タブ４での「最終出力」、タブ５でのユーザーが選んだ「場面の候補」、「スタイルの候補」、
ユーザーが記述したテキストを考慮して、挿絵の画像を２つ生成し、表示する。
７．生成された画像は、ユーザーがダウンロードできるようにする。
８．上記の内容以外のところは、絶対に省略したり、変更しないでください。
９．判断に迷う点があれば、独断で判断せず、問い合わせてください。
10.プログラムコードは、添付のコードをベースに変更、追加してください。
コードの出力は、完全なコードを出力してください。








